@startuml
actor Utilisateur

Utilisateur -> AuthController: POST /login (loginRequest)
AuthController -> JwtService: login(loginRequest)
JwtService -> Repository: Récupérer l'utilisateur et valider le mot de passe
Repository --> JwtService: L'utilisateur est valide
JwtService -> JwtService: Générer le JWT
JwtService --> AuthController: JWT
AuthController --> Utilisateur: JWT

Utilisateur -> SecurityFilter: GET /endpoint-securisé (avec le token Bearer)
note over of SecurityFilter
    Bean géré par Spring
    (défini dans configuration
    de Spring Security)
end note

SecurityFilter -> JwtDecoder: Valider la signature du token et les claims (exp, aud, etc.)
note over of JwtDecoder
    Bean géré par Spring
    (défini dans configuration
    de Spring Security)
end note
JwtDecoder --> SecurityFilter: Le token est valide
SecurityFilter -> SecurityContext: Définir l'objet Authentication
SecurityFilter -> RestController: Continuer vers l'exécution du contrôleur
RestController --> Utilisateur: Réponse (données, 200)

@enduml